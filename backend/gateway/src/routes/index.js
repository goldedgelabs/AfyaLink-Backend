module.exports = (prisma) => { const express = require('express'); const router = express.Router(); router.post('/auth/login', async (req,res)=>{ const { email } = req.body||{}; if(!email) return res.status(400).json({ message:'email required' }); const user = prisma.user ? await prisma.user.findUnique({ where:{ email } }).catch(()=>null) : null; if(!user) return res.status(401).json({ message:'Invalid' }); res.json({ ok:true, token:'dev-token', user:{ id:user.id, email:user.email, role:user.role } }); }); router.get('/patients', async (req,res)=>{ const list = prisma.patient ? await prisma.patient.findMany().catch(()=>[]) : []; res.json({ ok:true, data:list }); }); return router; }